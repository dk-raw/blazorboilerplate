@using BlazorBoilerplate.Shared.Dto.Sample
@using Microsoft.AspNetCore.Components.Forms

<EditForm OnValidSubmit="CreateMessage" Model="@messageDto" >
    <div class="card-footer">
            @if (Creating)
            {
                <MudButton FullWidth="true">
                    <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Creating...
                </MudButton>
            }
            else
            {                
                <MudButtonGroup Color="Color.Primary" Variant="Variant.Outlined">
                    <MudTextField @bind-Value="@messageDto.Text" />
                    <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary">Send</MudButton>
                </MudButtonGroup>
            }
    </div>
</EditForm>

@code
{
    MessageDto messageDto { get; set; } = new MessageDto();

    [Parameter]
    public Func<MessageDto, Task> Send { get; set; }

    bool IsOpened { get; set; }

    bool Creating { get; set; } = false;

    async Task CreateMessage()
    {
        Creating = true;
        StateHasChanged();
        await Send(messageDto);
        messageDto.Text = string.Empty;
        Creating = false;
        StateHasChanged();
    }
}